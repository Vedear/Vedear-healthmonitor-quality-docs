# Инцидент: Ошибка в работе системы "HealthMonitor 2024-01-15"

## Краткое описание
Сервис HealthMonitor испытывал повышенную латентность и ошибки 503 Service Unavailable в период пиковой нагрузки. Деградация производительности затронула 30% пользовательских запросов, преимущественно в модуле сбора метрик здоровья.

## Время обнаружения и время воздействия
- **Время обнаружения**: 2024-01-15 14:23 UTC
- **Начало воздействия**: 2024-01-15 14:15 UTC
- **Конец воздействия**: 2024-01-15 15:45 UTC
- **Общая продолжительность**: 1 час 30 минут
- **Пиковая деградация**: 14:30-15:15 UTC (45 минут)

## Предварительные действия
1. **Автоматическое масштабирование**: Система автоскейлинга увеличила количество инстансов с 5 до 12
2. **Балансировка нагрузки**: Перераспределение трафика на наименее загруженные ноды
3. **Кеширование**: Временное увеличение TTL для часто запрашиваемых данных
4. **Автоматическое выключение**: Включение механизма автоматическое выключение для проблемных эндпоинтов
5. **Роллбек**: Откат последнего деплоя (v1.2.3 → v1.2.2)

## Корневая причина
- **Утечка памяти** в новом алгоритме агрегации метрик здоровья
- **Недостаточное тестирование** под нагрузкой перед релизом
- **Некорректная конфигурация** лимитов памяти в контейнерах
- **Отсутствие мониторинга** потребления памяти в реальном времени
- **Неоптимальные запросы** к базе данных в новом функционале

## План устранения

| Действие | Ответственный | Срок |
|----------|---------------|------|
| Патч для утечки памяти в алгоритме агрегации | Разработчик: Максим | 2024-01-16 |
| Увеличение лимитов памяти для контейнеров | Разработчик: Максим | 2024-01-16 |
| Настройка алертинга по потреблению памяти | Тестировщик: Вадим | 2024-01-17 |
| Оптимизация запросов к БД | Разработчик: Максим | 2024-01-18 |
| Нагрузочное тестирование исправлений | Тестировщик: Вадим | 2024-01-19 |
| Обновление процедуры код-ревью | Разработчик: Максим | 2024-01-22 |
| Внедрение поэтапное развёртывание новой версии системы | Разработчик: Максим | 2024-01-25 |

## Ссылки на логи и метрики

### Мониторинг и метрики
- [Grafana Dashboard - Performance Metrics]()
- [Prometheus - Memory Usage Graphs]()
- [APM Traces - Slow Requests]()

### Логи и ошибки
- [Kibana - Application Logs]()
- [Error Tracking - Sentry]()
- [Database Query Logs]()

### Системные метрики
- [Kubernetes Pod Metrics]()
- [Container Resource Usage]()
- [Load Balancer Metrics]()

### Документация инцидента
- [Post-mortem Document]()
- [Incident Timeline Recording]()
- [Slack Channel Archive]()